
            <!DOCTYPE html>
            <html lang="en">
                <head>
                    <!-- Character Encoding -->
                    <meta charset="UTF-8">

                    <!-- Viewport for Responsive Design -->
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">

                    <!-- Page Title -->
                    <title>Python Insert_Rows.py Source Code</title>

                    <!-- Meta Description for SEO -->
                    <meta name="description" content="A practice code page for displaying Insert_Rows.py python snippets.">

                    <!-- Meta Keywords -->
                    <meta name="keywords" content="code, snippets, python, programming, syntax highlighting, development">

                    <!-- Author Information -->
                    <meta name="author" content="Mike Dinder">

                    <!-- HTTP Equiv Headers -->
                    <meta http-equiv="X-UA-Compatible" content="IE=edge">
                    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

                    <!-- Robots Meta Tag -->
                    <meta name="robots" content="index, follow">

                    <!-- Open Graph Meta Tags for Social Media -->
                    <meta property="og:title" content="Display Insert_Rows.py Code Snippets">
                    <meta property="og:description" content="A practice code page for displaying Insert_Rows.py python snippets.">
                    <meta property="og:type" content="website">
                    <meta property="og:url" content="https://www.mikedinder.com//home/mike/Python/Generated_HTML/Insert_Rows.html">
                    <meta property="og:image" content="https://www.mikedinder.com/mikedinder.jpg">

                    <!-- Twitter Card Meta Tags -->
                    <meta name="twitter:card" content="summary_large_image">
                    <meta name="twitter:title" content="Display Insert_Rows.py Code Snippets">
                    <meta name="twitter:description" content="A practice code page for displaying Insert_Rows.py python snippets.">
                    <meta name="twitter:image" content="https://www.mikedinder.com/mikedinder.jpg">

                    <!-- Favicon -->
                    <link rel="icon" type="image/x-icon" href="/favicon.ico">
                    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">

                    <!-- Theme Color for Mobile Browsers -->
                    <meta name="theme-color" content="#1e293b">

                    <!-- Preconnect to CDN for Performance -->
                    <!-- <link rel="preconnect" href="https://cdnjs.cloudflare.com"> -->

                    <!-- Highlight.js for Syntax Highlighting -->
                    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

                    <!-- Custom Styles -->
                    <style type="text/css">
                        * {
                            margin: 0;
                            padding: 0;
                            box-sizing: border-box;
                        }

                        body {
                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
                            line-height: 1.6;
                            color: #e2e8f0;
                            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
                            min-height: 100vh;
                            padding: 20px;
                        }

                        .container {
                            max-width: 1200px;
                            margin: 0 auto;
                        }

                        header {
                            text-align: center;
                            margin-bottom: 40px;
                            padding: 20px;
                        }

                        h1 {
                            font-size: 2.5rem;
                            color: #60a5fa;
                            margin-bottom: 10px;
                        }

                        .subtitle {
                            color: #94a3b8;
                            font-size: 1.1rem;
                        }

                        .snippet-container {
                            background: #1e293b;
                            border-radius: 12px;
                            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                            margin-bottom: 30px;
                            overflow: hidden;
                            border: 1px solid #334155;
                        }

                        .snippet-header {
                            background: #0f172a;
                            padding: 15px 20px;
                            border-bottom: 1px solid #334155;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                        }

                        .snippet-title {
                            color: #f1f5f9;
                            font-size: 1.1rem;
                            font-weight: 600;
                        }

                        .language-badge {
                            background: #3b82f6;
                            color: white;
                            padding: 5px 12px;
                            border-radius: 20px;
                            font-size: 0.85rem;
                            font-weight: 500;
                        }

                        .snippet-body {
                            position: relative;
                        }

                        pre {
                            margin: 0;
                            padding: 35px 0 20px;
                            overflow-x: auto;
                        }

                        code {
                            font-family: 'Courier New', Courier, monospace;
                            font-size: 0.95rem;
                        }

                        .copy-button {
                            position: absolute;
                            top: 10px;
                            right: 10px;
                            background: #3b82f6;
                            color: white;
                            border: none;
                            padding: 8px 16px;
                            border-radius: 6px;
                            cursor: pointer;
                            font-size: 0.9rem;
                            transition: background 0.3s ease;
                        }

                        .copy-button:hover {
                            background: #2563eb;
                        }

                        .copy-button:active {
                            background: #1d4ed8;
                        }

                        footer {
                            text-align: center;
                            margin-top: 50px;
                            padding: 20px;
                            color: #64748b;
                        }

                        @media (max-width: 768px) {
                            h1 {
                                font-size: 2rem;
                            }

                            .snippet-header {
                                flex-direction: column;
                                gap: 10px;
                                align-items: flex-start;
                            }
                        }
                    </style>
                </head>

                <body>
                    <div class="container">
                        <header>
                            <h1>Source Code Snippets of "Insert_Rows.py"</h1>
                            <h2>Mike Dinder</h2>
                            <p class="subtitle">The entire contents of the "Insert_Rows.py" file as code examples with syntax highlighting</p>
                            <p class="subtitle">
                                Auto Generated Using <a href="https://claude.ai" target="_blank">Generate_HTML.py</a> script to auto format each of these pages in a standardized template.
                            </p>
                        </header>

                        <main>
                            <!-- Python Snippet -->
                            <div class="snippet-container">
                                <div class="snippet-header">
                                    <span class="snippet-title">Insert_Rows</span>
                                    <span class="language-badge">Python</span>
                                </div>

                                <div class="snippet-body">
                                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                                    <pre>
                                        <code class="language-python"># Add Records to the Users Table
import psycopg2

from Connect import connect
from psycopg2 import sql


def insert_rows(conn=None, table_name='', columns=[], row_info=(), return_identifier='id') -> tuple[list, list]:
    """
    Insert a new User into the User table and return the User ID.

    :param conn: Object, Database Connection
    :param table_name: String, Database Table Name
    :param columns: List of Column Names
    :param row_info: List of Row Info (Each as Tuples) to Insert, Each Column Value
    :param return_identifier: String, primary key identifier to return
    :returns table_ids: List of ID's of new User Records.
    :rtype: list of int or other return_identifier
    :returns returns_list: List of Return Items E.g. ("{{first_name}} {{last_name}}") Value if users table, else []
    :rtype: list of str
    """
    print(f'************* Now Inserting into the {table_name.upper()} Table *************')
    cursor = conn.cursor()
    columns_sql = ', '.join(['%s'] * len(columns))
    col_identifiers = [sql.Identifier(name) for name in columns]
    cols = sql.SQL(', ').join(col_identifiers)

    if table_name == 'book_authors':
        returning_identifiers = [
            sql.Identifier(columns[0]),
            sql.Identifier(columns[1])
        ]
    elif table_name == 'users':
        returning_identifiers = [
            sql.Identifier(return_identifier),
            sql.Identifier(columns[0]),
            sql.Identifier(columns[1])
        ]
    else:
        returning_identifiers = [
            sql.Identifier(return_identifier)
        ]

    returning = sql.SQL(', ').join(returning_identifiers)

    # The SQL statement uses %s as a placeholder for the Table fields to prevent SQL injection
    # query = """
    #     INSERT INTO {} ({}, {}, {})
    #     VALUES (%s, %s, %s)
    #     RETURNING id, {}, {};
    # """
    query = f"""
        INSERT INTO {{}} ({{}})
        VALUES ({columns_sql})
        RETURNING {{}};
    """
    table_ids = []
    returns_list = []
    successful_inserts = 0
    failed_inserts = 0

    # Execute Many - Wont Continue If One Already Exists with Unique Constraint
    # try:
    #     query = cursor.executemany(
    #         sql.SQL(query).format(
    #             sql.Identifier(table_name),
    #             sql.Identifier(columns[0]),
    #             sql.Identifier(columns[1]),
    #             sql.Identifier(columns[2])
    #         ),
    #         row_info
    #     )
    # except (Exception, psycopg2.DatabaseError) as e:
    #     print(f'Error Inserting User Record: {e}')
    #     conn.rollback()
    # else:
    #     conn.commit()
    #     executed_query_bytes = cursor.query
    #     executed_query_str = executed_query_bytes.decode('utf-8')

    #     print(f'Executed Query: {executed_query_str}')
    #     print(f'{cursor.rowcount} Records Inserted Successfully.')

    # for first_name, last_name, email in row_info:
    for row in row_info:
        try:
            # cursor.execute(
            #     sql.SQL(query).format(
            #         sql.Identifier(table_name),
            #         sql.Identifier(columns[0]),
            #         sql.Identifier(columns[1]),
            #         sql.Identifier(columns[2]),
            #         sql.Identifier(columns[0]),
            #         sql.Identifier(columns[1])
            #     ),
            #     row
            # )
            cursor.execute(
                sql.SQL(query).format(
                    sql.Identifier(table_name),
                    cols,
                    returning
                ),
                row
            )
        except (Exception, psycopg2.DatabaseError, psycopg2.IntegrityError) as e:
            print(f'Error Inserting {table_name} Table Record: {e}')
            conn.rollback()
            failed_inserts += 1
        else:
            conn.commit()
            successful_inserts += 1
            executed_query_bytes = cursor.query
            executed_query_str = executed_query_bytes.decode('utf-8')

            print(f'Executed Query: {executed_query_str}')

            result = cursor.fetchall()[0]

            table_ids.append(result[0])

            if table_name == 'book_authors':
                returns_list.append(str(result[0]) + '-' + str(result[1]))
            elif table_name == 'users':
                returns_list.append(result[1] + ' ' + result[2])

    print(f'{successful_inserts} Records Inserted Successfully.')
    print(f'{failed_inserts} Records Failed to Insert')
    print(f'List of "{table_name}" Table ID\'s:', table_ids)

    if table_name == 'book_authors':
        print('List of Book/Author ID\'s:', returns_list)
    elif table_name == 'users':
        print('List of User Names:', returns_list)

    print('--------------------------------------------------')

    # Close the Cursor and Connection
    if cursor:
        cursor.close()

    # if conn:
    #     conn.close()

    return table_ids, returns_list


if __name__ == '__main__':
    conn = connect()

    if conn:
        # Insert Rows
        insert_rows(
            conn, 'users', [
                'first_name',
                'last_name',
                'email'
            ],
            [
                ('Mike', 'Dinder', 'mike@mikedinder.com'),
                ('Robb', 'Dinder', 'robb@mikedinder.com'),
                ('Roger', 'ROlast', 'roger@mikedinder.com'),
                ('Chris', 'CHlast', 'chris@mikedinder.com'),
                ('Sean', 'SElast', 'sean@mikedinder.com'),
                ('Catherine', 'CAlast', 'catherine@mikedinder.com'),
                ('Liz', 'Llast', 'liz@mikedinder.com'),
                ('Ruby', 'RUlast', 'ruby@mikedinder.com'),
                ('Rachel', 'RAlast', 'rachel@mikedinder.com'),
                ('Vienna', 'Vlast', 'vienna@mikedinder.com'),
            ]
        )

        conn.close()
</code>
                                    </pre>
                                </div>
                            </div>
                        </main>

                        <footer>
                            <p>&copy; 2026 MikeDinder.com - Code Snippets Display. Built with Python, HTML, CSS, and Highlight.js</p>
                        </footer>
                    </div>

                    <!-- Initialize Highlight.js -->
                    <script type="text/javascript">
                        // Initialize syntax highlighting
                        hljs.highlightAll();

                        // Copy code function
                        function copyCode(button) {
                            const codeBlock = button.nextElementSibling.querySelector('code');
                            const code = codeBlock.textContent;

                            navigator.clipboard.writeText(code).then(() => {
                                const originalText = button.textContent;
                                button.textContent = 'Copied!';
                                button.style.background = '#10b981';

                                setTimeout(() => {
                                    button.textContent = originalText;
                                    button.style.background = '#3b82f6';
                                }, 2000);
                            }).catch(err => {
                                console.error('Failed to copy code:', err);
                                button.textContent = 'Error!';
                                button.style.background = '#ef4444';

                                setTimeout(() => {
                                    button.textContent = 'Copy';
                                    button.style.background = '#3b82f6';
                                }, 2000);
                            });
                        }
                    </script>
                </body>
            </html>
        